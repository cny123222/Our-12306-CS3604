### 3. 车次列表页

#### 3.1 车次列表页布局

##### 3.1.1 整体页面布局
- **背景**：页面主体背景为白色。
- **布局**：从上到下依次为顶部导航区、车票查询区、筛选与列表区、底部导航区。

##### 3.1.2 顶部导航区域
- 与首页和登录页保持一致的通用顶部导航栏。
- **Logo 区域**：页面左上角为Logo区域（直接使用图片“登录页-顶部导航区域-Logo区域.png”），左侧为中国铁路12306官方Logo，logo右侧上方为黑色“中国铁路12306”、下方为灰色“12306 CHINA RAILWAY”，点击logo可跳转到12306首页
            - **欢迎信息**：Logo区域右侧为欢迎信息区域，显示黑色“欢迎登录12306”
##### 3.1.3 车票查询区域
- **位置**：位于顶部导航栏下方，作为页面的核心交互区域之一，始终保持可见。
- **功能**：
    - **行程类型**：提供“单程”模式的单选按钮。
    - **出发地/目的地**：提供输入框，允许用户输入或选择出发地和目的地。中间有一个可点击的“交换”图标。
    - **出发/返回日期**：提供日期选择控件，用于选择出行日期。
    - **查询按钮**：橙色的“查询”按钮，用于提交查询请求。

##### 3.1.4 筛选与列表区域
- **日期快速选择**：在车票查询区域下方，提供一个横向的日期条，展示最近两周的日期，方便用户快速切换查询日期。
- **多维度筛选区**：
    - **位置**：位于日期选择条下方，车次列表上方。
    - **筛选条件**：提供多种筛选维度，每个维度为一组复选框或选项。包括：
        - **车次类型**：如“GC-高铁/城际”、“D-动车”、“Z-直达”等。
        - **出发时段**：将一天划分为“00:00-06:00”、“06:00-12:00”、“12:00-18:00”、“18:00-24:00”四个时段。
        - **出发车站/到达车站**：列出当前查询结果中涉及的所有出发和到达车站，供用户勾选。
        - **车次席别**：列出所有可能的席别，如“一等座”、“二等座”等。
- **车次列表概要**：
    - **位置**：筛选区下方，列表正上方。
    - **内容**：显示查询的概要信息，例如“北京 --> 上海 (11月10日 周一) 共计51个车次”。
- **车次列表**：
    - **布局**：以表格形式展示所有符合条件的车次。
    - **表头**：包含“车次”、“出发站/到达站”、“出发时间/到达时间”、“历时”、各类席别（“一等座”等）、“备注”和操作列。表头中的“出发时间”和“历时”支持点击排序。
    - **数据行**：每一行代表一个车次，清晰展示该车次的所有信息，并在最右侧提供“预订”按钮。

##### 3.1.5 底部导航区域
- 与首页和登录页保持一致的通用底部区域。
- **内容**：包含友情链接、官方平台二维码（中国铁路官方微信、微博，12306公众号、APP）、版权信息及备案号。

#### 3.2 页面功能概述
车次列表页是用户在首页完成车票查询后进入的页面。该页面核心功能是展示所有符合查询条件的车次信息，并提供丰富的筛选、排序功能，最终引导用户选择特定车次进入订单填写页。

#### 3.3 详细功能需求

##### 3.3.1 车次查询与列表加载
- **Scenario: 用户执行查询后，页面成功加载车次列表**
    - **Given**: 用户在首页或本页的查询模块输入了有效的出发地（如“上海”）、目的地（如“北京”）和出发日期。
    - **When**: 用户点击“查询”按钮。
    - **Then**: 页面跳转至车次列表页，并首先显示一个加载中（Loading）的动画或提示。
    - **And**: 系统根据查询条件，在后台完成数据检索后，加载动画消失。
    - **And**: 页面清晰地展示从“上海”到“北京”的所有车次信息列表。
    - **And**: 页面顶部会固定显示“北京 --> 上海 (11月9日 周日) 共计51个车次”之类的概要信息。

##### 3.3.2 车次信息展示
- **Scenario: 车次列表正确显示各列信息**
    - **Given**: 车次列表已成功加载。
    - **When**: 用户浏览车次列表。
    - **Then**: 列表以表格形式展示，包含以下列：“车次”、“出发站/到达站”、“出发时间/到达时间”、“历时”、“商务座/特等座”、“一等座”、“二等座”、“高级软卧”、“软卧”、“动卧”、“硬卧”、“软座”、“硬座”、“无座”、“其他”以及“备注”。
    - **And**: “车次”列显示唯一的列车编号，如“G103”。
    - **And**: “出发站/到达站”列显示本次列车在该查询区间内的具体始发和终到车站，如“上海虹桥”和“北京南”。
    - **And**: “出发时间/到达时间”列显示对应的到发时间，如“06:20”和“11:58”。
    - **And**: “历时”列显示总行程耗时，如“05:38”。

- **Scenario: 鼠标悬停显示经停站信息**
    - **Given**: 车次列表已成功加载。
    - **When**: 用户将鼠标悬停在任意一个车次代码上（例如“G103”）。
    - **Then**: 页面应立即弹出一个浮动窗口（Tooltip或Popover）。
    - **And**: 该窗口内以列表形式清晰展示此车次从始发站到终点站的所有经停站名称、到站时间、发车时间以及停留时长。

- **Scenario: 特殊车次标识**
    - **Given**: 车次列表已成功加载。
    - **When**: 列表中包含“复兴号”或“智能动车组”等特殊车型。
    - **Then**: 在车次号下方应有明显的图标或文字标识，如“复兴号”或“智能动车组”图标，以便用户快速识别。

- **Scenario: 余票信息显示逻辑**
    - **Given**: 车次列表已成功加载。
    - **When**: 系统渲染各席位的余票信息。
    - **Then**: 余票信息应有三种状态：
        - **有**: 表示余票充足（如，大于20张），显示“有”字。
        - **数字**: 当余票紧张时（如，小于等于20张），直接显示具体的余票数量，如“13”。
        - **--**: 表示该车次不提供此席位，或该席位车票已售罄。
        - **候补**: 表示该席位已售罄，但用户可以进行候补购票。
    - **And**: **（核心业务逻辑）** 余票的判断必须基于用户查询的【出发地】到【目的地】的完整路径。系统需要检查该车次从【出发地】到【目的地】所经过的 **每一个** 中间站区间的路段是否都有余票。只有当所有相关路段均有余票时，才判定该席位在用户查询的区间内“有票”。

##### 3.3.3 筛选功能
- **Scenario: 用户按车次类型筛选**
    - **Given**: 页面已显示完整的车次列表。
    - **When**: 用户在“车次类型”区域勾选“GC-高铁/城际”。
    - **Then**: 列表应在100ms内动态刷新，仅显示车次为G、C、D开头的列车。
    - **And**: 当用户取消勾选时，列表恢复显示所有类型的车次。

- **Scenario: 用户按出发时段筛选**
    - **Given**: 页面已显示完整的车次列表。
    - **When**: 用户在“出发时段”区域选择“12:00-18:00”。
    - **Then**: 列表应在100ms内动态刷新，仅显示出发时间在该范围内的车次。

- **Scenario: 用户按出发/到达车站筛选**
    - **Given**: 页面已显示完整的车次列表。
    - **When**: 用户在“出发车站”或“到达车站”的下拉列表中选择一个或多个特定车站。
    - **Then**: 列表应在100ms内动态刷新，仅显示从指定车站出发或到达指定车站的车次。

- **Scenario: 用户按席别筛选**
    - **Given**: 页面已显示完整的车次列表。
    - **When**: 用户在“车次席别”区域勾选“一等座”。
    - **Then**: 列表应在100ms内动态刷新，仅显示提供一等座且有票或可候补的车次。

- **Scenario: 用户使用快捷选项筛选**
    - **Given**: 页面已显示完整的车次列表。
    - **When**: 用户勾选“显示折扣车次”或“显示积分兑换车次”。
    - **Then**: 列表应在100ms内动态刷新，仅显示符合对应条件的车次。

##### 3.3.4 排序功能
- **Scenario: 用户按出发时间排序**
    - **Given**: 页面已显示完整的车次列表。
    - **When**: 用户点击“出发时间”列表头。
    - **Then**: 列表应按出发时间从早到晚（升序）排列。
    - **And**: 当用户再次点击“出发时间”列表头时，列表应按从晚到早（降序）排列。

- **Scenario: 用户按历时排序**
    - **Given**: 页面已显示完整的车次列表。
    - **When**: 用户点击“历时”列表头。
    - **Then**: 列表应按行程耗时从短到长（升序）排列。
    - **And**: 当用户再次点击“历时”列表头时，列表应按从长到短（降序）排列。

##### 3.3.5 预订操作
- **Scenario: 用户点击“预订”按钮**
    - **Given**: 用户查看到一个有余票（状态为“有”或数字）的车次。
    - **When**: 用户点击该车次所在行的“预订”按钮。
    - **Then**: 系统应立即跳转到“订单填写页”。
    - **And**: 必须将所选车次的详细信息（如车次号、出发日期、出发地、目的地、席位信息等）正确传递给订单填写页。

- **Scenario: 用户尝试预订无票车次**
    - **Given**: 用户查看到一个无余票（状态为“--”）的车次。
    - **When**: 用户查看该车次所在行。
    - **Then**: 该行的“预订”按钮应为灰色不可点击状态，并显示“无票”或类似提示。

##### 3.3.6 界面过期提示
    - **Given**: 用户成功查询并加载了车次列表，但2分钟时间内未进行任何操作。
    - **When**: 用户在页面停留较长时间后，点击任一车次的“预订”按钮。
    - **Then**: 系统应弹出一个提示框，内容为：“车票信息已过期，请重新查询最新车票信息”，并提供一个“确定”按钮。
    - **And**: 用户点击“确定”后，提示框关闭，页面需要刷新或引导用户重新查询。

##### 3.3.7 未登录用户点击预订提示登录
- **Scenario: 未登录用户点击预订提示登录**
    - **Given**: 用户未登录系统，但成功查询并加载了车次列表。
    - **When**: 用户点击任一车次的“预订”按钮。
    - **Then**: 系统应跳转到登录页面，并提示用户“您尚未登录，请登录后再试”。
    - **And**: 登录成功后，系统应能返回到之前的车次列表页面，或保留用户的查询条件，以便用户重新查询。