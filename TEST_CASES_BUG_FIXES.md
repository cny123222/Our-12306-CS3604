# Bugä¿®å¤æµ‹è¯•ç”¨ä¾‹ Bug Fix Test Cases

æœ¬æ–‡æ¡£åŒ…å«é’ˆå¯¹3ä¸ªå·²ä¿®å¤é—®é¢˜çš„è¯¦ç»†æµ‹è¯•ç”¨ä¾‹ã€‚

---

## æµ‹è¯•ç”¨ä¾‹ç´¢å¼•

1. [TC-BF-001: æ³¨å†Œé¡µé¢æœåŠ¡æ¡æ¬¾å‹¾é€‰æ¡†åŠŸèƒ½æµ‹è¯•](#tc-bf-001)
2. [TC-BF-002: æ³¨å†Œåç™»å½•åŠŸèƒ½æµ‹è¯•](#tc-bf-002)
3. [TC-BF-003: çŸ­ä¿¡éªŒè¯ç Terminalæ˜¾ç¤ºæµ‹è¯•](#tc-bf-003)
4. [TC-BF-004: é‚®ç®±éªŒè¯ç Terminalæ˜¾ç¤ºæµ‹è¯•](#tc-bf-004)
5. [TC-BF-005: æ³¨å†Œæµç¨‹å®Œæ•´æ€§æµ‹è¯•](#tc-bf-005)
6. [TC-BF-006: CORSè·¨åŸŸé—®é¢˜æµ‹è¯•](#tc-bf-006)

---

## <a name="tc-bf-001"></a>TC-BF-001: æ³¨å†Œé¡µé¢æœåŠ¡æ¡æ¬¾å‹¾é€‰æ¡†åŠŸèƒ½æµ‹è¯•

### æµ‹è¯•ç›®æ ‡
éªŒè¯æ³¨å†Œé¡µé¢çš„"æˆ‘å·²é˜…è¯»å¹¶åŒæ„éµå®ˆæœåŠ¡æ¡æ¬¾"å‹¾é€‰æ¡†èƒ½å¤Ÿæ­£å¸¸å‹¾é€‰å’Œå–æ¶ˆå‹¾é€‰ã€‚

### å‰ç½®æ¡ä»¶
- å‰ç«¯æœåŠ¡è¿è¡Œåœ¨ http://localhost:5174
- æµè§ˆå™¨å·²æ‰“å¼€æ³¨å†Œé¡µé¢

### æµ‹è¯•æ­¥éª¤

| æ­¥éª¤ | æ“ä½œ | é¢„æœŸç»“æœ |
|------|------|----------|
| 1 | è®¿é—® http://localhost:5174/register | æˆåŠŸåŠ è½½æ³¨å†Œé¡µé¢ |
| 2 | å®šä½åˆ°"æˆ‘å·²é˜…è¯»å¹¶åŒæ„éµå®ˆã€Šä¸­å›½é“è·¯å®¢æˆ·æœåŠ¡ä¸­å¿ƒç½‘ç«™æœåŠ¡æ¡æ¬¾ã€‹ã€Šéšç§æƒæ”¿ç­–ã€‹"å‹¾é€‰æ¡† | å‹¾é€‰æ¡†å¯è§ï¼Œåˆå§‹çŠ¶æ€ä¸ºæœªå‹¾é€‰ |
| 3 | ç‚¹å‡»å‹¾é€‰æ¡† | å‹¾é€‰æ¡†è¢«é€‰ä¸­ï¼Œæ˜¾ç¤ºå‹¾é€‰æ ‡è®° âœ“ |
| 4 | å†æ¬¡ç‚¹å‡»å‹¾é€‰æ¡† | å‹¾é€‰æ¡†å–æ¶ˆé€‰ä¸­ï¼Œå‹¾é€‰æ ‡è®°æ¶ˆå¤± |
| 5 | ç‚¹å‡»å‹¾é€‰æ¡†ä½¿å…¶é€‰ä¸­ | å‹¾é€‰æ¡†è¢«é€‰ä¸­ |
| 6 | ç‚¹å‡»å‹¾é€‰æ¡†æ—è¾¹çš„æ–‡å­— | å‹¾é€‰æ¡†çŠ¶æ€åˆ‡æ¢ï¼ˆè¢«é€‰ä¸­åˆ™å–æ¶ˆï¼Œæœªé€‰ä¸­åˆ™é€‰ä¸­ï¼‰ |
| 7 | å¡«å†™æ‰€æœ‰æ³¨å†Œä¿¡æ¯ï¼Œä½†ä¸å‹¾é€‰æœåŠ¡æ¡æ¬¾ | - |
| 8 | ç‚¹å‡»"ç«‹å³æ³¨å†Œ"æŒ‰é’® | æ˜¾ç¤ºé”™è¯¯æç¤ºï¼š"è¯·é˜…è¯»å¹¶åŒæ„æœåŠ¡æ¡æ¬¾ï¼" |
| 9 | å‹¾é€‰æœåŠ¡æ¡æ¬¾ | é”™è¯¯æç¤ºæ¶ˆå¤± |

### æµ‹è¯•æ•°æ®
- æ— éœ€ç‰¹å®šæµ‹è¯•æ•°æ®

### éªŒæ”¶æ ‡å‡†
- âœ… å‹¾é€‰æ¡†å¯ä»¥æ­£å¸¸ç‚¹å‡»
- âœ… å‹¾é€‰çŠ¶æ€æ­£ç¡®åˆ‡æ¢
- âœ… ç‚¹å‡»æ–‡å­—æ ‡ç­¾ä¹Ÿèƒ½åˆ‡æ¢å‹¾é€‰çŠ¶æ€
- âœ… æœªå‹¾é€‰æ—¶æäº¤æ³¨å†Œæ˜¾ç¤ºé”™è¯¯æç¤º
- âœ… å‹¾é€‰åå¯ä»¥æ­£å¸¸æäº¤æ³¨å†Œ

### æŠ€æœ¯å®ç°éªŒè¯
æ£€æŸ¥ `frontend/src/components/RegisterForm.jsx` ç¬¬150è¡Œï¼š
```javascript
onChange={(e) => updateField('agreedToTerms')(e.target.checked)}
```
ç¡®è®¤ä½¿ç”¨äº†æ­£ç¡®çš„å‡½æ•°è°ƒç”¨æ–¹å¼ã€‚

---

## <a name="tc-bf-002"></a>TC-BF-002: æ³¨å†Œåç™»å½•åŠŸèƒ½æµ‹è¯•

### æµ‹è¯•ç›®æ ‡
éªŒè¯ç”¨æˆ·æ³¨å†ŒæˆåŠŸåï¼Œèƒ½å¤Ÿä½¿ç”¨æ³¨å†Œæ—¶çš„ç”¨æˆ·åå’Œå¯†ç æˆåŠŸç™»å½•ã€‚

### å‰ç½®æ¡ä»¶
- å‰ç«¯æœåŠ¡è¿è¡Œåœ¨ http://localhost:5174
- åç«¯æœåŠ¡è¿è¡Œåœ¨ http://localhost:3000
- æ•°æ®åº“å·²åˆå§‹åŒ–

### æµ‹è¯•æ­¥éª¤

| æ­¥éª¤ | æ“ä½œ | é¢„æœŸç»“æœ |
|------|------|----------|
| 1 | è®¿é—® http://localhost:5174/register | æˆåŠŸåŠ è½½æ³¨å†Œé¡µé¢ |
| 2 | å¡«å†™å®Œæ•´çš„æ³¨å†Œä¿¡æ¯ï¼š<br>- ç”¨æˆ·å: testuser888<br>- å¯†ç : test123_<br>- ç¡®è®¤å¯†ç : test123_<br>- è¯ä»¶ç±»å‹: å±…æ°‘èº«ä»½è¯<br>- å§“å: å¼ ä¸‰<br>- è¯ä»¶å·ç : 110101199001018888<br>- ä¼˜æƒ ç±»å‹: æˆäºº<br>- é‚®ç®±: test888@example.com<br>- æ‰‹æœºå·: 13800138888<br>- å‹¾é€‰æœåŠ¡æ¡æ¬¾: âœ“ | æ‰€æœ‰å­—æ®µæ­£ç¡®å¡«å†™ |
| 3 | ç‚¹å‡»"ç«‹å³æ³¨å†Œ"æŒ‰é’® | æ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼Œæ³¨å†ŒæˆåŠŸ |
| 4 | ç­‰å¾…é¡µé¢è·³è½¬æˆ–æ˜¾ç¤ºæˆåŠŸæç¤º | æç¤ºæ³¨å†ŒæˆåŠŸï¼Œè·å–åˆ° userId |
| 5 | è®¿é—® http://localhost:5174/login | æˆåŠŸåŠ è½½ç™»å½•é¡µé¢ |
| 6 | è¾“å…¥æ³¨å†Œæ—¶çš„ç”¨æˆ·å: testuser888 | ç”¨æˆ·åè¾“å…¥æ¡†æ˜¾ç¤º testuser888 |
| 7 | è¾“å…¥æ³¨å†Œæ—¶çš„å¯†ç : test123_ | å¯†ç è¾“å…¥æ¡†æ˜¾ç¤º â—â—â—â—â—â—â—â— |
| 8 | ç‚¹å‡»"ç™»å½•"æŒ‰é’® | ç™»å½•éªŒè¯æˆåŠŸï¼Œæç¤º"è´¦å·å¯†ç éªŒè¯æˆåŠŸï¼Œè¯·è¿›è¡ŒçŸ­ä¿¡éªŒè¯" |
| 9 | è¾“å…¥è¯ä»¶å·å4ä½: 8888 | è¯ä»¶å·è¾“å…¥æ¡†æ˜¾ç¤º 8888 |
| 10 | ç‚¹å‡»"è·å–çŸ­ä¿¡éªŒè¯ç "æŒ‰é’® | æ˜¾ç¤º"è·å–çŸ­ä¿¡éªŒè¯ç æˆåŠŸï¼"ï¼Œæ‰‹æœºå·æ˜¾ç¤ºä¸º 138****8888 |
| 11 | æŸ¥çœ‹åç«¯terminal | æ˜¾ç¤ºéªŒè¯ç ä¿¡æ¯ï¼ˆè§ä¸‹æ–¹æ ¼å¼ï¼‰ |
| 12 | è¾“å…¥terminalä¸­æ˜¾ç¤ºçš„éªŒè¯ç  | éªŒè¯ç è¾“å…¥æ¡†å¡«å……6ä½æ•°å­— |
| 13 | ç‚¹å‡»"ç™»å½•"æŒ‰é’® | ç™»å½•æˆåŠŸï¼Œè·³è½¬åˆ°é¦–é¡µæˆ–ä¸ªäººä¸­å¿ƒ |

### æµ‹è¯•æ•°æ®

#### æ³¨å†Œæµ‹è¯•æ•°æ®
```json
{
  "username": "testuser888",
  "password": "test123_",
  "confirmPassword": "test123_",
  "idType": "å±…æ°‘èº«ä»½è¯",
  "realName": "å¼ ä¸‰",
  "idNumber": "110101199001018888",
  "discountType": "æˆäºº",
  "email": "test888@example.com",
  "phone": "13800138888",
  "agreedToTerms": true
}
```

#### ç™»å½•æµ‹è¯•æ•°æ®
```json
{
  "credential": "testuser888",
  "password": "test123_"
}
```

### éªŒæ”¶æ ‡å‡†
- âœ… æ³¨å†ŒAPIè°ƒç”¨æˆåŠŸï¼Œè¿”å›userId
- âœ… æ³¨å†Œçš„ç”¨æˆ·ä¿¡æ¯æ­£ç¡®ä¿å­˜åˆ°æ•°æ®åº“
- âœ… ä½¿ç”¨æ³¨å†Œçš„ç”¨æˆ·åå¯ä»¥æŸ¥æ‰¾åˆ°ç”¨æˆ·
- âœ… å¯†ç éªŒè¯æˆåŠŸï¼ˆæ˜æ–‡å¯¹æ¯”æˆ–bcryptéªŒè¯ï¼‰
- âœ… ç™»å½•è¿”å›requiresVerification=true
- âœ… æ•´ä¸ªæµç¨‹æ— æŠ¥é”™

### APIéªŒè¯

#### æ³¨å†ŒAPIè°ƒç”¨
```bash
curl -X POST http://localhost:3000/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser888",
    "password": "test123_",
    "confirmPassword": "test123_",
    "idType": "å±…æ°‘èº«ä»½è¯",
    "realName": "å¼ ä¸‰",
    "idNumber": "110101199001018888",
    "discountType": "æˆäºº",
    "email": "test888@example.com",
    "phone": "13800138888",
    "agreedToTerms": true
  }'
```

**é¢„æœŸå“åº” (201 Created):**
```json
{
  "userId": "user_1762838894773_42joed91a",
  "message": "æ³¨å†ŒæˆåŠŸ"
}
```

#### ç™»å½•APIè°ƒç”¨
```bash
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "credential": "testuser888",
    "password": "test123_"
  }'
```

**é¢„æœŸå“åº” (200 OK):**
```json
{
  "requiresVerification": true,
  "userId": "user_1762838894773_42joed91a",
  "message": "è´¦å·å¯†ç éªŒè¯æˆåŠŸï¼Œè¯·è¿›è¡ŒçŸ­ä¿¡éªŒè¯"
}
```

### æŠ€æœ¯å®ç°éªŒè¯
1. æ£€æŸ¥ `frontend/src/components/RegisterForm.jsx` handleSubmit å‡½æ•°
2. ç¡®è®¤è°ƒç”¨äº† `POST /api/auth/register` API
3. ç¡®è®¤ `backend/src/services/authService.js` register å‡½æ•°æ­£ç¡®ä¿å­˜ç”¨æˆ·æ•°æ®
4. ç¡®è®¤ `backend/src/services/authService.js` login å‡½æ•°èƒ½æ‰¾åˆ°æ³¨å†Œçš„ç”¨æˆ·

---

## <a name="tc-bf-003"></a>TC-BF-003: çŸ­ä¿¡éªŒè¯ç Terminalæ˜¾ç¤ºæµ‹è¯•

### æµ‹è¯•ç›®æ ‡
éªŒè¯å‘é€çŸ­ä¿¡éªŒè¯ç æ—¶ï¼ŒéªŒè¯ç ä»¥æ¸…æ™°æ ¼å¼åœ¨åç«¯terminalä¸­æ˜¾ç¤ºï¼Œå¹¶ä¸”èƒ½å¤Ÿæ­£ç¡®éªŒè¯ã€‚

### å‰ç½®æ¡ä»¶
- åç«¯æœåŠ¡è¿è¡Œåœ¨ http://localhost:3000
- å·²æœ‰æ³¨å†Œç”¨æˆ·ï¼ˆå¯ä½¿ç”¨TC-BF-002åˆ›å»ºï¼‰
- åç«¯terminalçª—å£å¯è§

### æµ‹è¯•æ­¥éª¤

| æ­¥éª¤ | æ“ä½œ | é¢„æœŸç»“æœ |
|------|------|----------|
| 1 | ä½¿ç”¨æ³¨å†Œçš„ç”¨æˆ·åå’Œå¯†ç ç™»å½• | ç™»å½•æˆåŠŸï¼Œè¿›å…¥éªŒè¯ç è¾“å…¥é¡µé¢ |
| 2 | è¾“å…¥è¯ä»¶å·å4ä½ | è¯ä»¶å·è¾“å…¥æ¡†æ˜¾ç¤º4ä½æ•°å­— |
| 3 | ç‚¹å‡»"è·å–çŸ­ä¿¡éªŒè¯ç "æŒ‰é’® | APIè°ƒç”¨æˆåŠŸï¼Œæ˜¾ç¤º"è·å–çŸ­ä¿¡éªŒè¯ç æˆåŠŸï¼" |
| 4 | æŸ¥çœ‹è¿è¡Œ `npm start` çš„åç«¯terminalçª—å£ | æ˜¾ç¤ºä»¥ä¸‹æ ¼å¼çš„éªŒè¯ç ä¿¡æ¯ï¼š<br>```<br>========================================<br>ğŸ“± çŸ­ä¿¡éªŒè¯ç  SMS Verification Code<br>========================================<br>ç”¨æˆ·ID (User ID): user_xxx<br>æ‰‹æœºå· (Phone): 138xxxxx<br>éªŒè¯ç  (Code): 123456<br>æœ‰æ•ˆæœŸ (Valid until): 2025-11-11T05:26:19.258Z<br>========================================<br>``` |
| 5 | è®°å½•terminalä¸­æ˜¾ç¤ºçš„6ä½éªŒè¯ç  | éªŒè¯ç ä¸º6ä½æ•°å­— |
| 6 | åœ¨ç½‘é¡µä¸­è¾“å…¥è¯¥éªŒè¯ç  | éªŒè¯ç è¾“å…¥æ¡†æ˜¾ç¤º6ä½æ•°å­— |
| 7 | ç‚¹å‡»"ç™»å½•"æŒ‰é’® | éªŒè¯ç éªŒè¯æˆåŠŸï¼Œç™»å½•æˆåŠŸ |
| 8 | å†æ¬¡å°è¯•ä½¿ç”¨ç›¸åŒéªŒè¯ç ç™»å½•å¦ä¸€ä¸ªä¼šè¯ | éªŒè¯å¤±è´¥ï¼Œæç¤º"éªŒè¯ç æ ¡éªŒå¤±è´¥ï¼"æˆ–"å¾ˆæŠ±æ­‰ï¼Œæ‚¨è¾“å…¥çš„çŸ­ä¿¡éªŒè¯ç æœ‰è¯¯ã€‚" |

### æµ‹è¯•æ•°æ®

#### å‘é€éªŒè¯ç è¯·æ±‚
```bash
curl -X POST http://localhost:3000/api/auth/send-verification-code \
  -H "Content-Type: application/json" \
  -d '{
    "userId": "user_1762838478736_3mwc52ir9",
    "idNumberLast4": "8706"
  }'
```

**é¢„æœŸå“åº” (200 OK):**
```json
{
  "message": "è·å–çŸ­ä¿¡éªŒè¯ç æˆåŠŸï¼",
  "phoneNumberMasked": "138****8706"
}
```

**é¢„æœŸTerminalè¾“å‡º:**
```
========================================
ğŸ“± çŸ­ä¿¡éªŒè¯ç  SMS Verification Code
========================================
ç”¨æˆ·ID (User ID): user_1762838478736_3mwc52ir9
æ‰‹æœºå· (Phone): 13838478706
éªŒè¯ç  (Code): 962944
æœ‰æ•ˆæœŸ (Valid until): 2025-11-11T05:26:19.258Z
========================================
```

#### éªŒè¯éªŒè¯ç è¯·æ±‚
```bash
curl -X POST http://localhost:3000/api/auth/verify-login-code \
  -H "Content-Type: application/json" \
  -d '{
    "userId": "user_1762838478736_3mwc52ir9",
    "idNumberLast4": "8706",
    "verificationCode": "962944"
  }'
```

**é¢„æœŸå“åº” (200 OK):**
```json
{
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "userId": "user_1762838478736_3mwc52ir9",
    "username": "testuser38478706",
    "phone": "13838478706"
  },
  "message": "ç™»å½•æˆåŠŸ"
}
```

### éªŒæ”¶æ ‡å‡†
- âœ… éªŒè¯ç åœ¨terminalä¸­ä»¥æ¸…æ™°æ ¼å¼æ˜¾ç¤º
- âœ… éªŒè¯ç ä¸º6ä½æ•°å­—
- âœ… Terminalè¾“å‡ºåŒ…å«ç”¨æˆ·IDã€æ‰‹æœºå·ã€éªŒè¯ç ã€æœ‰æ•ˆæœŸ
- âœ… éªŒè¯ç æœ‰æ•ˆæœŸä¸º5åˆ†é’Ÿ
- âœ… éªŒè¯ç å¯ä»¥æˆåŠŸéªŒè¯
- âœ… éªŒè¯ç ä½¿ç”¨åä¸å¯é‡å¤ä½¿ç”¨
- âœ… 1åˆ†é’Ÿå†…ä¸èƒ½é‡å¤è¯·æ±‚åŒä¸€ç”¨æˆ·çš„éªŒè¯ç 

### æŠ€æœ¯å®ç°éªŒè¯
1. æ£€æŸ¥ `backend/src/database/authDB.js` createVerificationCode å‡½æ•°
2. ç¡®è®¤åŒ…å« console.log è¾“å‡ºéªŒè¯ç ä¿¡æ¯
3. ç¡®è®¤éªŒè¯ç ä¿å­˜åˆ° verification_codes è¡¨ï¼Œtype='sms'
4. ç¡®è®¤ verifyCode å‡½æ•°æ­£ç¡®éªŒè¯éªŒè¯ç 

---

## <a name="tc-bf-004"></a>TC-BF-004: é‚®ç®±éªŒè¯ç Terminalæ˜¾ç¤ºæµ‹è¯•

### æµ‹è¯•ç›®æ ‡
éªŒè¯é‚®ç®±éªŒè¯ç åŠŸèƒ½ï¼Œç¡®è®¤éªŒè¯ç åœ¨terminalä¸­æ­£ç¡®æ˜¾ç¤ºã€‚

### å‰ç½®æ¡ä»¶
- åç«¯æœåŠ¡è¿è¡Œåœ¨ http://localhost:3000
- æ•°æ®åº“å·²åˆ›å»º createEmailVerificationCode å‡½æ•°
- åç«¯terminalçª—å£å¯è§

### æµ‹è¯•æ­¥éª¤

| æ­¥éª¤ | æ“ä½œ | é¢„æœŸç»“æœ |
|------|------|----------|
| 1 | è°ƒç”¨é‚®ç®±éªŒè¯ç APIï¼ˆå¦‚å·²å®ç°å‰ç«¯åŠŸèƒ½ï¼‰ | APIè°ƒç”¨æˆåŠŸ |
| 2 | æŸ¥çœ‹åç«¯terminal | æ˜¾ç¤ºé‚®ç®±éªŒè¯ç ä¿¡æ¯ï¼š<br>```<br>========================================<br>ğŸ“§ é‚®ç®±éªŒè¯ç  Email Verification Code<br>========================================<br>ç”¨æˆ·ID (User ID): user_xxx<br>é‚®ç®± (Email): test@example.com<br>éªŒè¯ç  (Code): 123456<br>æœ‰æ•ˆæœŸ (Valid until): 2025-11-11T05:26:19.258Z<br>========================================<br>``` |
| 3 | éªŒè¯ç ä¸º6ä½æ•°å­— | éªŒè¯é€šè¿‡ |
| 4 | ä½¿ç”¨éªŒè¯ç è¿›è¡ŒéªŒè¯ | éªŒè¯æˆåŠŸ |

### æµ‹è¯•æ•°æ®

#### åˆ›å»ºé‚®ç®±éªŒè¯ç ï¼ˆæ•°æ®åº“å±‚æµ‹è¯•ï¼‰
```javascript
import { createEmailVerificationCode } from './backend/src/database/authDB.js';

const code = await createEmailVerificationCode('user_test_123', 'test@example.com');
console.log('Generated code:', code);
```

**é¢„æœŸTerminalè¾“å‡º:**
```
========================================
ğŸ“§ é‚®ç®±éªŒè¯ç  Email Verification Code
========================================
ç”¨æˆ·ID (User ID): user_test_123
é‚®ç®± (Email): test@example.com
éªŒè¯ç  (Code): 654321
æœ‰æ•ˆæœŸ (Valid until): 2025-11-11T05:31:19.258Z
========================================
Generated code: 654321
```

### éªŒæ”¶æ ‡å‡†
- âœ… é‚®ç®±éªŒè¯ç åœ¨terminalä¸­ä»¥æ¸…æ™°æ ¼å¼æ˜¾ç¤º
- âœ… éªŒè¯ç ä¸º6ä½æ•°å­—
- âœ… Terminalè¾“å‡ºåŒ…å«ç”¨æˆ·IDã€é‚®ç®±ã€éªŒè¯ç ã€æœ‰æ•ˆæœŸ
- âœ… éªŒè¯ç æœ‰æ•ˆæœŸä¸º5åˆ†é’Ÿ
- âœ… éªŒè¯ç ä¿å­˜åˆ°æ•°æ®åº“ï¼Œtype='email'

### æŠ€æœ¯å®ç°éªŒè¯
1. æ£€æŸ¥ `backend/src/database/authDB.js` createEmailVerificationCode å‡½æ•°
2. ç¡®è®¤åŒ…å« console.log è¾“å‡ºéªŒè¯ç ä¿¡æ¯
3. ç¡®è®¤éªŒè¯ç ä¿å­˜åˆ° verification_codes è¡¨ï¼Œtype='email'

---

## <a name="tc-bf-005"></a>TC-BF-005: æ³¨å†Œæµç¨‹å®Œæ•´æ€§æµ‹è¯•

### æµ‹è¯•ç›®æ ‡
ç«¯åˆ°ç«¯æµ‹è¯•å®Œæ•´çš„æ³¨å†Œæµç¨‹ï¼Œä»å¡«å†™è¡¨å•åˆ°æ³¨å†ŒæˆåŠŸã€‚

### å‰ç½®æ¡ä»¶
- å‰ç«¯æœåŠ¡è¿è¡Œåœ¨ http://localhost:5174
- åç«¯æœåŠ¡è¿è¡Œåœ¨ http://localhost:3000

### æµ‹è¯•æ­¥éª¤

| æ­¥éª¤ | æ“ä½œ | é¢„æœŸç»“æœ |
|------|------|----------|
| 1 | è®¿é—®æ³¨å†Œé¡µé¢ | é¡µé¢åŠ è½½æˆåŠŸ |
| 2 | å¡«å†™æ‰€æœ‰å¿…å¡«å­—æ®µ | æ‰€æœ‰å­—æ®µæ­£ç¡®å¡«å†™ |
| 3 | ä¸å‹¾é€‰æœåŠ¡æ¡æ¬¾ï¼Œç‚¹å‡»æ³¨å†Œ | æ˜¾ç¤ºé”™è¯¯ï¼š"è¯·é˜…è¯»å¹¶åŒæ„æœåŠ¡æ¡æ¬¾ï¼" |
| 4 | å‹¾é€‰æœåŠ¡æ¡æ¬¾ | å‹¾é€‰æˆåŠŸ |
| 5 | ç‚¹å‡»æ³¨å†ŒæŒ‰é’® | æŒ‰é’®æ˜¾ç¤ºåŠ è½½çŠ¶æ€ |
| 6 | ç­‰å¾…APIå“åº” | æ³¨å†ŒæˆåŠŸï¼Œè·å–userId |
| 7 | é¡µé¢è·³è½¬æˆ–æ˜¾ç¤ºæˆåŠŸæç¤º | æç¤ºæ³¨å†ŒæˆåŠŸ |
| 8 | éªŒè¯æ•°æ®åº“ | ç”¨æˆ·æ•°æ®æ­£ç¡®ä¿å­˜ |

### è‡ªåŠ¨åŒ–æµ‹è¯•è„šæœ¬
ä½¿ç”¨æä¾›çš„ `test-registration.js` è„šæœ¬ï¼š

```bash
cd /Users/od/Desktop/cs3604/Our-12306-CS3604
node test-registration.js
```

**é¢„æœŸè¾“å‡º:**
```
========================================
å¼€å§‹æµ‹è¯•æ³¨å†Œå’Œç™»å½•æµç¨‹
========================================

========================================
æµ‹è¯•æ³¨å†ŒåŠŸèƒ½
========================================
å‘é€æ³¨å†Œè¯·æ±‚...
âœ… æ³¨å†ŒæˆåŠŸ!
ç”¨æˆ·ID: user_xxx
ç”¨æˆ·å: testuserxxx

========================================
æµ‹è¯•ç™»å½•åŠŸèƒ½
========================================
å‘é€ç™»å½•è¯·æ±‚...
âœ… ç™»å½•æˆåŠŸï¼ˆéœ€è¦çŸ­ä¿¡éªŒè¯ï¼‰
ç”¨æˆ·ID: user_xxx

========================================
æµ‹è¯•å‘é€çŸ­ä¿¡éªŒè¯ç 
========================================
å‘é€çŸ­ä¿¡éªŒè¯ç è¯·æ±‚...
âœ… çŸ­ä¿¡éªŒè¯ç å‘é€æˆåŠŸ!
æ©ç æ‰‹æœºå·: 138****xxxx

ğŸ‘† è¯·æŸ¥çœ‹ä¸Šæ–¹terminalè¾“å‡ºçš„éªŒè¯ç 
```

### éªŒæ”¶æ ‡å‡†
- âœ… æ‰€æœ‰å­—æ®µéªŒè¯æ­£ç¡®
- âœ… æœåŠ¡æ¡æ¬¾å‹¾é€‰éªŒè¯å·¥ä½œ
- âœ… APIè°ƒç”¨æˆåŠŸ
- âœ… æ•°æ®æ­£ç¡®ä¿å­˜
- âœ… æ— ä»»ä½•JavaScripté”™è¯¯
- âœ… æ— ç½‘ç»œè¯·æ±‚å¤±è´¥

---

## <a name="tc-bf-006"></a>TC-BF-006: CORSè·¨åŸŸé—®é¢˜æµ‹è¯•

### æµ‹è¯•ç›®æ ‡
éªŒè¯å‰ç«¯å¯ä»¥æ­£å¸¸è®¿é—®åç«¯APIï¼Œæ— CORSè·¨åŸŸé”™è¯¯ã€‚

### å‰ç½®æ¡ä»¶
- å‰ç«¯è¿è¡Œåœ¨ http://localhost:5174
- åç«¯è¿è¡Œåœ¨ http://localhost:3000

### æµ‹è¯•æ­¥éª¤

| æ­¥éª¤ | æ“ä½œ | é¢„æœŸç»“æœ |
|------|------|----------|
| 1 | æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ | å¼€å‘è€…å·¥å…·æ‰“å¼€ |
| 2 | åˆ‡æ¢åˆ°Consoleæ ‡ç­¾é¡µ | æ˜¾ç¤ºæ§åˆ¶å° |
| 3 | åœ¨æ³¨å†Œé¡µé¢å¡«å†™è¡¨å•å¹¶æäº¤ | APIè¯·æ±‚å‘é€ |
| 4 | æŸ¥çœ‹Networkæ ‡ç­¾é¡µ | æ˜¾ç¤ºAPIè¯·æ±‚ |
| 5 | æ£€æŸ¥è¯·æ±‚çŠ¶æ€ | çŠ¶æ€ç ä¸º 200 æˆ– 201 |
| 6 | æ£€æŸ¥Console | æ— CORSç›¸å…³é”™è¯¯ |
| 7 | æ£€æŸ¥Response Headers | åŒ…å« `Access-Control-Allow-Origin: http://localhost:5174` |

### å¸¸è§CORSé”™è¯¯

å¦‚æœCORSé…ç½®é”™è¯¯ï¼Œä¼šçœ‹åˆ°ä»¥ä¸‹é”™è¯¯ï¼š
```
Access to fetch at 'http://localhost:3000/api/auth/register' from origin 'http://localhost:5174' 
has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource.
```

### éªŒæ”¶æ ‡å‡†
- âœ… æ— CORSé”™è¯¯
- âœ… APIè¯·æ±‚æˆåŠŸ
- âœ… Response HeadersåŒ…å«æ­£ç¡®çš„CORSå¤´
- âœ… å‰ç«¯å¯ä»¥æ­£å¸¸è°ƒç”¨æ‰€æœ‰åç«¯API

### æŠ€æœ¯å®ç°éªŒè¯
æ£€æŸ¥ `backend/src/server.js` ç¬¬15-18è¡Œï¼š
```javascript
app.use(cors({ 
  origin: process.env.CORS_ORIGIN || ['http://localhost:5173', 'http://localhost:5174'],
  credentials: true 
}));
```

---

## æµ‹è¯•æ‰§è¡Œæ¸…å•

### æ‰‹åŠ¨æµ‹è¯•æ¸…å•
- [ ] TC-BF-001: å‹¾é€‰æ¡†åŠŸèƒ½æµ‹è¯•
- [ ] TC-BF-002: æ³¨å†Œåç™»å½•æµ‹è¯•
- [ ] TC-BF-003: çŸ­ä¿¡éªŒè¯ç æ˜¾ç¤ºæµ‹è¯•
- [ ] TC-BF-004: é‚®ç®±éªŒè¯ç æ˜¾ç¤ºæµ‹è¯•
- [ ] TC-BF-005: æ³¨å†Œæµç¨‹å®Œæ•´æ€§æµ‹è¯•
- [ ] TC-BF-006: CORSè·¨åŸŸé—®é¢˜æµ‹è¯•

### è‡ªåŠ¨åŒ–æµ‹è¯•æ¸…å•
- [ ] è¿è¡Œ `node test-registration.js` å¹¶éªŒè¯æ‰€æœ‰æ­¥éª¤é€šè¿‡
- [ ] æ£€æŸ¥åç«¯terminalæ˜¾ç¤ºéªŒè¯ç 
- [ ] éªŒè¯éªŒè¯ç å¯ä»¥æˆåŠŸç™»å½•

### APIæµ‹è¯•æ¸…å•
- [ ] POST /api/auth/register - æ³¨å†ŒAPI
- [ ] POST /api/auth/login - ç™»å½•API
- [ ] POST /api/auth/send-verification-code - å‘é€éªŒè¯ç API
- [ ] POST /api/auth/verify-login-code - éªŒè¯éªŒè¯ç API
- [ ] POST /api/auth/check-username - æ£€æŸ¥ç”¨æˆ·åAPI

---

## å›å½’æµ‹è¯•

åœ¨ä¿®å¤è¿™äº›bugåï¼Œåº”æ‰§è¡Œä»¥ä¸‹å›å½’æµ‹è¯•ï¼š

### å‰ç«¯å›å½’æµ‹è¯•
```bash
cd frontend
npm test
```

### åç«¯å›å½’æµ‹è¯•
```bash
cd backend
npm test
```

### é›†æˆæµ‹è¯•
```bash
cd /Users/od/Desktop/cs3604/Our-12306-CS3604
node verify-system.js
node integration-test.js
```

---

## æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

### æµ‹è¯•æ‰§è¡ŒæŠ¥å‘Š

**æµ‹è¯•æ—¥æœŸ:** YYYY-MM-DD  
**æµ‹è¯•äººå‘˜:** [å§“å]  
**æµ‹è¯•ç¯å¢ƒ:**
- å‰ç«¯: http://localhost:5174
- åç«¯: http://localhost:3000
- æµè§ˆå™¨: [Chrome/Firefox/Safari] [ç‰ˆæœ¬å·]

**æµ‹è¯•ç»“æœ:**

| æµ‹è¯•ç”¨ä¾‹ID | æµ‹è¯•ç”¨ä¾‹åç§° | æ‰§è¡Œç»“æœ | å¤‡æ³¨ |
|-----------|-------------|---------|------|
| TC-BF-001 | å‹¾é€‰æ¡†åŠŸèƒ½æµ‹è¯• | âœ… PASS | |
| TC-BF-002 | æ³¨å†Œåç™»å½•æµ‹è¯• | âœ… PASS | |
| TC-BF-003 | çŸ­ä¿¡éªŒè¯ç æ˜¾ç¤ºæµ‹è¯• | âœ… PASS | |
| TC-BF-004 | é‚®ç®±éªŒè¯ç æ˜¾ç¤ºæµ‹è¯• | âœ… PASS | |
| TC-BF-005 | æ³¨å†Œæµç¨‹å®Œæ•´æ€§æµ‹è¯• | âœ… PASS | |
| TC-BF-006 | CORSè·¨åŸŸé—®é¢˜æµ‹è¯• | âœ… PASS | |

**æ€»ç»“:**
- é€šè¿‡: 6/6
- å¤±è´¥: 0/6
- é€šè¿‡ç‡: 100%

**å‘ç°çš„é—®é¢˜:**
- æ— 

**å»ºè®®:**
- æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Œå¯ä»¥å‘å¸ƒ

